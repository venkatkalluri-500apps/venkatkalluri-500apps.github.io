(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ninjacapture48"],{"2cfc":function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("99af"),core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_array_find_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("7db0"),core_js_modules_es_array_find_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_array_find_js__WEBPACK_IMPORTED_MODULE_1__),regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("96cf"),regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_2__),_home_agile_Desktop_Public_infinity_public_2_node_modules_vue_babel_preset_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("c964"),_home_agile_Desktop_Public_infinity_public_2_node_modules_vue_babel_preset_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("276c"),_home_agile_Desktop_Public_infinity_public_2_node_modules_vue_babel_preset_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("e954"),_home_agile_Desktop_Public_infinity_public_2_node_modules_vue_babel_preset_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("920b"),_home_agile_Desktop_Public_infinity_public_2_node_modules_vue_babel_preset_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("92a6"),axios__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("bc3a"),axios__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_8__),_jwt__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("9b7b"),_core_data__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("a11a"),User_Server="https://api.${region}.500apps.com/auth/v1/users/domain_user_details?limit=50",Server="https://api.${region}.500apps.com/pbxplus/v1",Agent_Capability="https://pref.${region}.500apps.com/v2/app_pref?where=app_name='${app_name}' and pref_key='twilioDialer'",Voicemail_Server="https://api.${region}.500apps.com/voxdesk/v1/voicemail-drop/${callsid}?audio_url=${audio_url}",Media_Server="https://api.${region}.500apps.com/files/?app=pbxplus&limit=50",DialerData=function(_Data){Object(_home_agile_Desktop_Public_infinity_public_2_node_modules_vue_babel_preset_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_6__["a"])(DialerData,_Data);var _super=Object(_home_agile_Desktop_Public_infinity_public_2_node_modules_vue_babel_preset_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_7__["a"])(DialerData);function DialerData(){return Object(_home_agile_Desktop_Public_infinity_public_2_node_modules_vue_babel_preset_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_4__["a"])(this,DialerData),_super.apply(this,arguments)}return Object(_home_agile_Desktop_Public_infinity_public_2_node_modules_vue_babel_preset_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_5__["a"])(DialerData,[{key:"getProfile",value:function(){var _getProfile=Object(_home_agile_Desktop_Public_infinity_public_2_node_modules_vue_babel_preset_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function _callee(){var headers,region,url,result,decoded,current_user;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_jwt__WEBPACK_IMPORTED_MODULE_9__["a"].setHeader();case 2:return headers=_context.sent,region=this.getRegion(),url=eval("`"+User_Server+"`"),_context.next=7,axios__WEBPACK_IMPORTED_MODULE_8___default.a.get(url,{headers:headers});case 7:if(result=_context.sent,decoded=_jwt__WEBPACK_IMPORTED_MODULE_9__["a"].getJWTDecoded(),decoded){_context.next=11;break}return _context.abrupt("return","");case 11:return current_user=result.data.find((function(e){return e.email==decoded.email})),_context.abrupt("return",current_user);case 13:case"end":return _context.stop()}}),_callee,this)})));function getProfile(){return _getProfile.apply(this,arguments)}return getProfile}()},{key:"getCapabilityVisitor",value:function(){var _getCapabilityVisitor=Object(_home_agile_Desktop_Public_infinity_public_2_node_modules_vue_babel_preset_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function _callee2(domain_id,callflow_id,api_key){var region,url,result;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return region=this.getRegion(),url=eval("`"+Server+"`"),_context2.next=4,axios__WEBPACK_IMPORTED_MODULE_8___default.a.get("".concat(url,"/c2c/").concat(domain_id,"/").concat(callflow_id,"/").concat(api_key));case 4:return result=_context2.sent,_context2.abrupt("return",result.data);case 6:case"end":return _context2.stop()}}),_callee2,this)})));function getCapabilityVisitor(e,t,_){return _getCapabilityVisitor.apply(this,arguments)}return getCapabilityVisitor}()},{key:"getCapabilityAgent",value:function(){var _getCapabilityAgent=Object(_home_agile_Desktop_Public_infinity_public_2_node_modules_vue_babel_preset_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function _callee3(app_name){var headers,region,url,result;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,_jwt__WEBPACK_IMPORTED_MODULE_9__["a"].setHeader();case 2:return headers=_context3.sent,region=this.getRegion(),url=eval("`"+Agent_Capability+"`"),_context3.next=7,axios__WEBPACK_IMPORTED_MODULE_8___default.a.get("".concat(url),{headers:headers});case 7:return result=_context3.sent,_context3.abrupt("return",result.data[0]);case 9:case"end":return _context3.stop()}}),_callee3,this)})));function getCapabilityAgent(e){return _getCapabilityAgent.apply(this,arguments)}return getCapabilityAgent}()},{key:"sendVoicemail",value:function(){var _sendVoicemail=Object(_home_agile_Desktop_Public_infinity_public_2_node_modules_vue_babel_preset_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function _callee4(callsid,audio_url){var headers,region,url,result;return regeneratorRuntime.wrap((function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,_jwt__WEBPACK_IMPORTED_MODULE_9__["a"].setHeader();case 2:return headers=_context4.sent,region=this.getRegion(),url=eval("`"+Voicemail_Server+"`"),_context4.next=7,axios__WEBPACK_IMPORTED_MODULE_8___default.a.get("".concat(url),{headers:headers});case 7:return result=_context4.sent,_context4.abrupt("return",result);case 9:case"end":return _context4.stop()}}),_callee4,this)})));function sendVoicemail(e,t){return _sendVoicemail.apply(this,arguments)}return sendVoicemail}()},{key:"getMedia",value:function(){var _getMedia=Object(_home_agile_Desktop_Public_infinity_public_2_node_modules_vue_babel_preset_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function _callee5(){var headers,region,url,result;return regeneratorRuntime.wrap((function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,_jwt__WEBPACK_IMPORTED_MODULE_9__["a"].setHeader();case 2:return headers=_context5.sent,region=this.getRegion(),url=eval("`"+Media_Server+"`"),_context5.next=7,axios__WEBPACK_IMPORTED_MODULE_8___default.a.get("".concat(url),{headers:headers});case 7:return result=_context5.sent,_context5.abrupt("return",result.data);case 9:case"end":return _context5.stop()}}),_callee5,this)})));function getMedia(){return _getMedia.apply(this,arguments)}return getMedia}()}]),DialerData}(_core_data__WEBPACK_IMPORTED_MODULE_10__["a"]);__webpack_exports__["a"]=new DialerData},"33fe":function(e,t,_){"use strict";_.r(t);var r=function(){var e=this,t=e.$createElement,_=e._self._c||t;return _("div",[e.connection?[_("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.showVoicemails",modifiers:{showVoicemails:!0}}],class:"text-center text-white rounded-0 d-flex flex-column align-items-center h-100 keyboard-number justify-content-center "+(e.disableVoicemailButton?"voxdesk-btn-disabled":""),attrs:{variant:"transparent",block:"",disabled:e.voice_mail||e.disableVoicemailButton}},[_("span",{staticClass:"fe fe-voicemail"}),_("small",[e._v("Voicemail")])])]:e._e(),_("b-modal",{attrs:{centered:"",size:"sm",id:"showVoicemails","body-class":"rounded-sm p-3","hide-footer":"","hide-header":""}},[_("b-dropdown",{attrs:{id:"voicemail_list",text:e.file,variant:"white",size:"sm",block:"","toggle-class":"d-flex justify-content-between align-items-center","menu-class":"vh-97 overflow-auto py-2"}},e._l(e.media,(function(t,r){return _("b-dropdown-item",{key:r,on:{click:function(_){e.sendVoicemail(t.key),e.file=t.key.split("/")[2]}}},[_("p",{staticClass:"mb-0 text-truncate"},[e._v(e._s(e.get_dropdown_text(t)))])])})),1),_("b-overlay",{attrs:{show:e.isBusy,"spinner-variant":"primary","spinner-small":"","no-wrap":"",opacity:"0.5"}}),_("span",{staticClass:"small",class:"text-"+e.style},[e._v(e._s(e.message))])],1)],2)},n=[],a=(_("ac1f"),_("1276"),_("96cf"),_("c964")),i=_("2cfc"),o=(_("99af"),_("276c")),s=_("e954"),c=_("fbf1"),u=_("f20d"),l=_("920b"),p=_("92a6"),d=_("a11a"),m=function(e){Object(l["a"])(_,e);var t=Object(p["a"])(_);function _(){return Object(o["a"])(this,_),t.apply(this,arguments)}return Object(s["a"])(_,[{key:"get_public_s3url",value:function(e){var t=Object(c["a"])(Object(u["a"])(_.prototype),"getRegion",this).call(this),r="dev"==t||"qa"==t?"ap1-".concat(t):t;return"https://".concat(r,"-infinity-user-data.s3.amazonaws.com/").concat(e)}}]),_}(d["a"]),b=new m,f={props:{connection:Object,disableVoicemailButton:Boolean},data:function(){return{media:[],voice_mail:!1,file:"Select Voicemail",isBusy:!1,message:"",style:"success"}},created:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i["a"].getMedia();case 2:e.media=t.sent;case 3:case"end":return t.stop()}}),t)})))()},methods:{sendVoicemail:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function _(){var r;return regeneratorRuntime.wrap((function(_){while(1)switch(_.prev=_.next){case 0:return console.log("connection",t.connection),t.isBusy=!0,_.next=4,b.get_public_s3url(e);case 4:return r=_.sent,_.prev=5,_.next=8,i["a"].sendVoicemail(t.connection.parameters.CallSid,r);case 8:t.message="Voicemail dropped",t.$bvModal.hide("showVoicemails"),_.next=18;break;case 12:_.prev=12,_.t0=_["catch"](5),console.log("error",_.t0),window.e=_.t0,t.message="Unable to drop voicemail",t.style="danger";case 18:t.isBusy=!1;case 19:case"end":return _.stop()}}),_,null,[[5,12]])})))()},get_dropdown_text:function(e){var t=e.key.split("/");return 4==t.length?t[3]:t[2]}}},h=f,g=(_("c856"),_("2877")),E=Object(g["a"])(h,r,n,!1,null,null,null);t["default"]=E.exports},"7db0":function(e,t,_){"use strict";var r=_("23e7"),n=_("b727").find,a=_("44d2"),i=_("ae40"),o="find",s=!0,c=i(o);o in[]&&Array(1)[o]((function(){s=!1})),r({target:"Array",proto:!0,forced:s||!c},{find:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),a(o)},"8c65":function(e,t,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){try{return encodeURIComponent(e)}catch(t){console.error("error encode %o")}return null},n=function(e){try{return decodeURIComponent(e)}catch(t){console.error("error decode %o")}return null},a=function(e){return r(e).replace(/[\-\.\+\*]/g,"\\$&")},i={getItem:function(e){return e&&n(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+a(e)+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,t,_,n,a,i){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var o="";if(_)switch(_.constructor){case Number:o=_===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+_;break;case String:o="; expires="+_;break;case Date:o="; expires="+_.toUTCString();break;default:break}return document.cookie=[r(e),"=",r(t),o,a?"; domain="+a:"",n?"; path="+n:"",i?"; secure":""].join(""),!0},removeItem:function(e,t,_){return!!this.hasItem(e)&&(document.cookie=[r(e),"=; expires=Thu, 01 Jan 1970 00:00:00 GMT",_?"; domain="+_:"",t?"; path="+t:""].join(""),!0)},hasItem:function(e){return!!e&&new RegExp("(?:^|;\\s*)"+r(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/);return e=e.map((function(e){return n(e)})),e}};t.default=i},"9b7b":function(e,t,_){"use strict";_("96cf");var r=_("c964"),n=_("276c"),a=_("e954"),i=_("8c65"),o=_.n(i);function s(e){this.message=e}s.prototype=new Error,s.prototype.name="InvalidCharacterError";var c="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new s("'atob' failed: The string to be decoded is not correctly encoded.");for(var _,r,n=0,a=0,i="";r=t.charAt(a++);~r&&(_=n%4?64*_+r:r,n++%4)?i+=String.fromCharCode(255&_>>(-2*n&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return i};function u(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(c(e).replace(/(.)/g,(function(e,t){var _=t.charCodeAt(0).toString(16).toUpperCase();return _.length<2&&(_="0"+_),"%"+_})))}(t)}catch(e){return c(t)}}function l(e){this.message=e}function p(e,t){if("string"!=typeof e)throw new l("Invalid token specified");var _=!0===(t=t||{}).header?0:1;try{return JSON.parse(u(e.split(".")[_]))}catch(e){throw new l("Invalid token specified: "+e.message)}}l.prototype=new Error,l.prototype.name="InvalidTokenError";var d=p,m=function(){function e(){Object(n["a"])(this,e)}return Object(a["a"])(e,[{key:"getJWT",value:function(){var e=o.a.getItem("token")||localStorage.getItem("token");if(e)try{var t=JSON.parse(e);this.jwt_token=d(t.jwt);var _="Bearer ".concat(t.jwt);return _}catch(r){return e}}},{key:"setHeader",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,_;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getJWT();case 2:return t=e.sent,_={},_["Authorization"]=t,e.abrupt("return",_);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getJWTDecoded",value:function(){var e=this.getJWT();if(e)return d(e)}}]),e}();t["a"]=new m},bbe1:function(e,t,_){},c856:function(e,t,_){"use strict";_("bbe1")}}]);
//# sourceMappingURL=ninjacapture48.99cd7793.js.map